<!DOCTYPE html>
<html lang="zh-CN">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pocket Garden - 玻璃水培箱</title>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
      }

      body,
      html {
        height: 100%;
        font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
        background: linear-gradient(135deg, #1a2a6c, #2a5298);
        overflow-x: hidden;
        color: #e0f7fa;
      }

      h1 {
        text-align: center;
        margin: 20px 0;
        font-size: 2.8rem;
        text-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
        letter-spacing: 2px;
        font-weight: 700;
        color: #a8e063;
      }

      .subtitle {
        text-align: center;
        font-size: 1.2rem;
        margin-bottom: 30px;
        color: #bbdefb;
        max-width: 800px;
        margin-left: auto;
        margin-right: auto;
        padding: 0 20px;
      }

      /* 侧边栏样式 */
      #toggle-sidebar {
        position: fixed;
        top: 20px;
        right: 20px;
        width: 50px;
        height: 50px;
        cursor: pointer;
        z-index: 999;
        display: flex;
        align-items: center;
        justify-content: center;
        background: rgba(76, 175, 80, 0.8);
        border-radius: 50%;
        box-shadow: 0 4px 12px rgba(0, 0, 0, 0.3);
        transition: all 0.3s ease;
        backdrop-filter: blur(5px);
      }

      #toggle-sidebar:hover {
        background: rgba(38, 166, 154, 0.9);
        transform: rotate(15deg);
      }

      .menu-icon {
        font-size: 28px;
        user-select: none;
        color: white;
      }

      #sidebar {
        position: fixed;
        top: 0;
        right: 0;
        width: 280px;
        height: 100vh;
        background: rgba(165, 214, 167, 0.85);
        box-shadow: -2px 0 15px rgba(0, 0, 0, 0.2);
        transform: translateX(100%);
        transition: transform 0.4s cubic-bezier(0.25, 0.46, 0.45, 0.94);
        z-index: 998;
        padding-top: 20px;
        border-left: 4px solid #4db6ac;
        backdrop-filter: blur(10px);
      }

      #sidebar.open {
        transform: translateX(0);
      }

      .sidebar-content {
        margin-top: 60px;
        display: flex;
        flex-direction: column;
        align-items: center;
        padding: 0 20px;
        gap: 30px;
      }

      .icon-item {
        display: flex;
        flex-direction: column;
        align-items: center;
        cursor: pointer;
        transition: transform 0.2s;
        width: 100%;
        padding: 15px;
        border-radius: 12px;
        background: rgba(255, 255, 255, 0.5);
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
      }

      .icon-item span {
        margin-top: 10px;
        font-size: 18px;
        color: #1b5e20;
        font-weight: 600;
      }

      .icon-item:hover {
        transform: translateY(-5px);
        background: rgba(255, 255, 255, 0.7);
      }

      .seed-section {
        width: 100%;
        display: flex;
        flex-direction: column;
        align-items: center;
        margin-top: 10px;
      }

      .seed-btn {
        background: linear-gradient(to right, #43a047, #66bb6a);
        color: white;
        border: none;
        padding: 12px 20px;
        font-size: 18px;
        border-radius: 30px;
        cursor: pointer;
        width: 100%;
        text-align: center;
        font-weight: bold;
        letter-spacing: 1px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        transition: all 0.3s;
      }

      .seed-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.25);
      }

      .seed-dropdown {
        display: none;
        width: 100%;
        margin-top: 15px;
        background: rgba(255, 255, 255, 0.9);
        border-radius: 12px;
        padding: 15px;
        box-sizing: border-box;
        z-index: 1000;
        grid-template-columns: repeat(3, 1fr);
        grid-gap: 15px;
        box-shadow: 0 8px 20px rgba(0, 0, 0, 0.15);
        border: 2px solid #e8f5e9;
      }

      .seed-icon {
        display: flex;
        flex-direction: column;
        align-items: center;
        cursor: grab;
        transition: all 0.3s ease;
        width: 100%;
        aspect-ratio: 1;
        background-color: white;
        border-radius: 10px;
        justify-content: center;
        overflow: hidden;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        border: 2px solid #c8e6c9;
      }

      .seed-icon img {
        max-width: 90%;
        max-height: 90%;
        object-fit: contain;
        transition: transform 0.3s;
      }

      .seed-icon:hover {
        transform: scale(1.05);
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
        border-color: #81c784;
      }

      .seed-icon:hover img {
        transform: scale(1.1);
      }

      .seed-icon:active {
        cursor: grabbing;
      }

      /* 玻璃水培箱容器 */
      .hydro-container {
        position: relative;
        width: 90%;
        max-width: 1400px;
        height: 450px;
        margin: 30px auto;
        border-radius: 20px;
        overflow: hidden;
        box-shadow: 0 20px 50px rgba(0, 0, 0, 0.5);
        background: rgba(255, 255, 255, 0.1);
        border: 4px solid rgba(255, 255, 255, 0.2);
        backdrop-filter: blur(5px);
        display: flex;
        flex-direction: column;
      }

      .hydro-header {
        padding: 15px 20px;
        background: rgba(0, 100, 100, 0.6);
        display: flex;
        justify-content: space-between;
        align-items: center;
      }

      .hydro-title {
        font-size: 1.8rem;
        color: #a8e063;
        font-weight: 600;
      }

      .hydro-stats {
        display: flex;
        gap: 20px;
      }

      .stat-item {
        display: flex;
        flex-direction: column;
        align-items: center;
      }

      .stat-value {
        font-size: 1.5rem;
        font-weight: bold;
        color: #4db6ac;
      }

      .stat-label {
        font-size: 0.9rem;
        color: #bbdefb;
      }

      /* 水培箱主体 */
      .hydro-body {
        position: relative;
        flex-grow: 1;
        background: linear-gradient(
          to bottom,
          rgba(32, 124, 148, 0.4),
          rgba(21, 74, 89, 0.6)
        );
        overflow-x: auto;
        overflow-y: hidden;
        scroll-behavior: smooth;
        scrollbar-width: thin;
        scrollbar-color: #4db6ac rgba(0, 0, 0, 0.2);
      }

      .hydro-body::-webkit-scrollbar {
        height: 12px;
      }

      .hydro-body::-webkit-scrollbar-track {
        background: rgba(0, 0, 0, 0.2);
        border-radius: 10px;
      }

      .hydro-body::-webkit-scrollbar-thumb {
        background: #4db6ac;
        border-radius: 10px;
      }

      .hydro-body::-webkit-scrollbar-thumb:hover {
        background: #26a69a;
      }

      .hydro-scroll-area {
        position: relative;
        width: 2000px;
        height: 100%;
        display: flex;
        align-items: center;
      }

      .water-background {
        position: absolute;
        top: 0;
        left: 0;
        width: 100%;
        height: 100%;
        background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" viewBox="0 0 100 100"><path d="M0,50 Q25,30 50,50 T100,50 L100,100 L0,100 Z" fill="%23207c94" opacity="0.3"/></svg>');
        background-size: 200px 100%;
        opacity: 0.5;
      }

      .bubbles {
        position: absolute;
        bottom: 0;
        width: 100%;
        height: 100px;
        background: url('data:image/svg+xml;utf8,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100"><circle cx="20" cy="80" r="3" fill="%23ffffff" opacity="0.6"/><circle cx="40" cy="70" r="2" fill="%23ffffff" opacity="0.5"/><circle cx="70" cy="85" r="4" fill="%23ffffff" opacity="0.7"/><circle cx="90" cy="75" r="2.5" fill="%23ffffff" opacity="0.6"/></svg>');
        background-size: 100px 100px;
        animation: bubbles 15s infinite linear;
      }

      @keyframes bubbles {
        0% {
          background-position: 0 0;
        }
        100% {
          background-position: 100px 0;
        }
      }

      .plant-area {
        position: relative;
        height: 100%;
        width: 100%;
        min-width: 2000px;
        z-index: 10;
      }

      /* 植物容器 */
      .plant-container {
        position: absolute;
        cursor: move;
        transition: transform 0.2s;
        z-index: 20;
      }

      .plant-container:hover {
        transform: scale(1.05);
      }

      .plant-video {
        width: 100%;
        height: auto;
        pointer-events: none;
      }

      .final-frame {
        width: 100%;
        height: auto;
        pointer-events: none;
      }

      .plant-info {
        position: absolute;
        bottom: -25px;
        left: 50%;
        transform: translateX(-50%);
        background: rgba(0, 0, 0, 0.6);
        color: white;
        padding: 3px 10px;
        border-radius: 10px;
        font-size: 12px;
        white-space: nowrap;
        opacity: 0;
        transition: opacity 0.3s;
      }

      .plant-container:hover .plant-info {
        opacity: 1;
      }

      /* 种子预览 */
      .seed-preview {
        position: absolute;
        width: 60px;
        height: 60px;
        border-radius: 10px;
        overflow: hidden;
        box-shadow: 0 5px 15px rgba(0, 0, 0, 0.3);
        z-index: 9999;
        pointer-events: none;
      }

      .seed-preview img {
        width: 100%;
        height: 100%;
        object-fit: cover;
      }

      .growing-text {
        position: absolute;
        top: 50%;
        left: 50%;
        transform: translate(-50%, -50%);
        font-size: 24px;
        color: #a8e063;
        font-weight: bold;
        text-shadow: 0 0 8px rgba(0, 0, 0, 0.8);
        opacity: 0;
        z-index: 30;
        animation: text-pop 1s ease-out forwards;
      }

      @keyframes text-pop {
        0% {
          opacity: 0;
          transform: translate(-50%, -30%);
        }
        50% {
          opacity: 1;
        }
        100% {
          opacity: 0;
          transform: translate(-50%, -70%);
        }
      }

      /* 控制按钮 */
      .hydro-controls {
        display: flex;
        justify-content: center;
        gap: 20px;
        margin-top: 30px;
      }

      .control-btn {
        background: linear-gradient(to right, #43a047, #66bb6a);
        color: white;
        border: none;
        padding: 12px 25px;
        font-size: 16px;
        border-radius: 30px;
        cursor: pointer;
        display: flex;
        align-items: center;
        gap: 8px;
        box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        transition: all 0.3s;
      }

      .control-btn:hover {
        transform: translateY(-3px);
        box-shadow: 0 6px 12px rgba(0, 0, 0, 0.25);
      }

      .hint {
        text-align: center;
        margin-top: 20px;
        font-size: 1.1rem;
        color: #bbdefb;
        padding: 10px;
        background: rgba(0, 0, 0, 0.2);
        border-radius: 10px;
        max-width: 800px;
        margin-left: auto;
        margin-right: auto;
      }

      .scroll-hint {
        position: absolute;
        bottom: 20px;
        left: 50%;
        transform: translateX(-50%);
        font-size: 16px;
        color: #a8e063;
        background: rgba(0, 0, 0, 0.6);
        padding: 8px 20px;
        border-radius: 30px;
        box-shadow: 0 4px 10px rgba(0, 0, 0, 0.2);
        animation: pulse 2s infinite;
        z-index: 5;
      }

      @keyframes pulse {
        0% {
          opacity: 0.7;
        }
        50% {
          opacity: 1;
        }
        100% {
          opacity: 0.7;
        }
      }

      footer {
        text-align: center;
        padding: 25px;
        color: #bbdefb;
        font-size: 1rem;
        margin-top: 40px;
      }
    </style>
  </head>
  <body>
    <h1>玻璃水培箱花田</h1>
    <p class="subtitle">
      拖拽种子到水培箱中任意位置种植植物。植物可以自由移动位置。
    </p>

    <div id="toggle-sidebar">
      <span class="menu-icon">☰</span>
    </div>

    <div id="sidebar">
      <div class="sidebar-content">
        <div class="icon-item">
          <span>营养液</span>
        </div>
        <div class="seed-section">
          <button id="seed-toggle-btn" class="seed-btn">🌱 水培种子</button>
          <div id="seed-dropdown" class="seed-dropdown">
            <div
              class="seed-icon"
              draggable="true"
              data-mp4="hydro1.mp4"
              data-plant="水培绿萝"
            >
              <img
                src="https://via.placeholder.com/100/81C784/FFFFFF?text=绿萝"
                alt="绿萝种子"
              />
            </div>
            <div
              class="seed-icon"
              draggable="true"
              data-mp4="hydro2.mp4"
              data-plant="水培吊兰"
            >
              <img
                src="https://via.placeholder.com/100/4CAF50/FFFFFF?text=吊兰"
                alt="吊兰种子"
              />
            </div>
            <div
              class="seed-icon"
              draggable="true"
              data-mp4="hydro3.mp4"
              data-plant="水培薄荷"
            >
              <img
                src="https://via.placeholder.com/100/388E3C/FFFFFF?text=薄荷"
                alt="薄荷种子"
              />
            </div>
            <div
              class="seed-icon"
              draggable="true"
              data-mp4="hydro4.mp4"
              data-plant="水培蕨类"
            >
              <img
                src="https://via.placeholder.com/100/2E7D32/FFFFFF?text=蕨类"
                alt="蕨类种子"
              />
            </div>
            <div
              class="seed-icon"
              draggable="true"
              data-mp4="hydro5.mp4"
              data-plant="水培常春藤"
            >
              <img
                src="https://via.placeholder.com/100/1B5E20/FFFFFF?text=常春藤"
                alt="常春藤种子"
              />
            </div>
            <div
              class="seed-icon"
              draggable="true"
              data-mp4="hydro6.mp4"
              data-plant="水培芦荟"
            >
              <img
                src="https://via.placeholder.com/100/8BC34A/FFFFFF?text=芦荟"
                alt="芦荟种子"
              />
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- 玻璃水培箱 -->
    <div class="hydro-container">
      <div class="hydro-header">
        <div class="hydro-title">🌿 智能水培系统</div>
        <div class="hydro-stats">
          <div class="stat-item">
            <div class="stat-value">23°C</div>
            <div class="stat-label">水温</div>
          </div>
          <div class="stat-item">
            <div class="stat-value">6.8</div>
            <div class="stat-label">PH值</div>
          </div>
          <div class="stat-item">
            <div class="stat-value">86%</div>
            <div class="stat-label">湿度</div>
          </div>
        </div>
      </div>

      <div class="hydro-body" id="hydroBody">
        <div class="hydro-scroll-area">
          <div class="water-background"></div>
          <div class="bubbles"></div>
          <div class="plant-area" id="plantArea">
            <div class="scroll-hint">← 左右滑动查看更多区域 →</div>
          </div>
        </div>
      </div>
    </div>

    <div class="hydro-controls">
      <button class="control-btn">💧 添加营养液</button>
      <button class="control-btn">🔆 调节光照</button>
      <button class="control-btn">🔄 换水循环</button>
      <button class="control-btn">📊 系统状态</button>
    </div>

    <p class="hint">
      提示：将种子拖拽到水培箱内任意位置种植。种植后可以拖动植物调整位置。
    </p>

    <footer>
      <p>Pocket Garden 水培系统 © 2023 | 打造您的室内水培花园</p>
    </footer>

    <script>
      document.addEventListener("DOMContentLoaded", () => {
        // 侧边栏切换逻辑
        const toggleSidebarBtn = document.getElementById("toggle-sidebar");
        const sidebar = document.getElementById("sidebar");

        toggleSidebarBtn.addEventListener("click", (e) => {
          e.stopPropagation();
          sidebar.classList.toggle("open");
        });

        // 点击空白处时隐藏侧边栏
        document.addEventListener("click", (e) => {
          if (
            !sidebar.contains(e.target) &&
            !toggleSidebarBtn.contains(e.target)
          ) {
            sidebar.classList.remove("open");
          }
        });

        // 种子菜单切换逻辑
        const seedToggleBtn = document.getElementById("seed-toggle-btn");
        const seedDropdown = document.getElementById("seed-dropdown");

        seedToggleBtn.addEventListener("click", (e) => {
          e.stopPropagation();
          seedDropdown.style.display =
            seedDropdown.style.display === "grid" ? "none" : "grid";
        });

        // 点击其他地方时隐藏种子菜单
        document.addEventListener("click", (e) => {
          if (
            !seedToggleBtn.contains(e.target) &&
            !seedDropdown.contains(e.target)
          ) {
            seedDropdown.style.display = "none";
          }
        });

        // 拖拽种子到水培箱逻辑
        const seedIcons = document.querySelectorAll(".seed-icon");
        const hydroBody = document.getElementById("hydroBody");
        const plantArea = document.getElementById("plantArea");

        // 种子图标启动拖拽
        seedIcons.forEach((icon) => {
          icon.addEventListener("dragstart", (e) => {
            const mp4Url = icon.getAttribute("data-mp4");
            const plantName = icon.getAttribute("data-plant");

            e.dataTransfer.setData("mp4", mp4Url);
            e.dataTransfer.setData("plant", plantName);

            // 创建拖拽预览图
            const preview = document.createElement("div");
            preview.className = "seed-preview";

            const img = document.createElement("img");
            img.src = icon.querySelector("img").src;

            preview.appendChild(img);
            document.body.appendChild(preview);
            e.dataTransfer.setDragImage(preview, 30, 30);

            setTimeout(() => {
              document.body.removeChild(preview);
            }, 0);
          });
        });

        // 在水培箱上处理拖放
        hydroBody.addEventListener("dragover", (e) => {
          e.preventDefault();
          hydroBody.style.boxShadow = "0 0 20px rgba(76, 175, 80, 0.7)";
        });

        hydroBody.addEventListener("dragleave", () => {
          hydroBody.style.boxShadow = "";
        });

        hydroBody.addEventListener("drop", (e) => {
          e.preventDefault();
          hydroBody.style.boxShadow = "";

          const mp4Url = e.dataTransfer.getData("mp4");
          const plantName = e.dataTransfer.getData("plant");
          if (!mp4Url) return;

          // 获取放置位置（相对于水培箱）
          const rect = hydroBody.getBoundingClientRect();
          const x = e.clientX - rect.left;
          const y = e.clientY - rect.top;

          // 创建植物容器
          const plantContainer = document.createElement("div");
          plantContainer.className = "plant-container";
          plantContainer.style.left = `${x}px`;
          plantContainer.style.top = `${y}px`;
          plantContainer.style.width = "120px";

          // 创建"生长中"文本效果
          const growingText = document.createElement("div");
          growingText.className = "growing-text";
          growingText.textContent = "🌱 生长中...";
          plantContainer.appendChild(growingText);

          // 3秒后移除文本
          setTimeout(() => {
            growingText.remove();
          }, 3000);

          // 创建视频元素
          const video = document.createElement("video");
          video.src = mp4Url;
          video.className = "plant-video";
          video.autoplay = true;
          video.muted = true;
          video.loop = false;
          video.playsInline = true;

          // 视频结束后暂停在最后一帧
          video.addEventListener("ended", function () {
            // 创建定格图像
            const canvas = document.createElement("canvas");
            const ctx = canvas.getContext("2d");
            canvas.width = video.videoWidth;
            canvas.height = video.videoHeight;
            ctx.drawImage(video, 0, 0, canvas.width, canvas.height);

            const finalFrame = document.createElement("img");
            finalFrame.className = "final-frame";
            finalFrame.src = canvas.toDataURL();

            // 添加到植物容器
            plantContainer.appendChild(finalFrame);

            // 添加植物信息
            const plantInfo = document.createElement("div");
            plantInfo.className = "plant-info";
            plantInfo.textContent = plantName;
            plantContainer.appendChild(plantInfo);

            // 移除视频
            video.remove();
          });

          // 添加到植物容器
          plantContainer.appendChild(video);

          // 添加到水培箱
          plantArea.appendChild(plantContainer);

          // 添加拖拽功能
          makePlantDraggable(plantContainer);
        });

        // 使植物可拖动的函数
        function makePlantDraggable(plant) {
          let isDragging = false;
          let offsetX, offsetY;

          plant.addEventListener("mousedown", startDrag);
          plant.addEventListener("touchstart", startDrag);

          function startDrag(e) {
            isDragging = true;

            // 计算鼠标/触摸点相对于元素的位置
            const rect = plant.getBoundingClientRect();
            if (e.type === "mousedown") {
              offsetX = e.clientX - rect.left;
              offsetY = e.clientY - rect.top;
            } else if (e.type === "touchstart") {
              offsetX = e.touches[0].clientX - rect.left;
              offsetY = e.touches[0].clientY - rect.top;
            }

            document.addEventListener("mousemove", drag);
            document.addEventListener("touchmove", drag);
            document.addEventListener("mouseup", stopDrag);
            document.addEventListener("touchend", stopDrag);

            e.preventDefault();
          }

          function drag(e) {
            if (!isDragging) return;

            let clientX, clientY;

            if (e.type === "mousemove") {
              clientX = e.clientX;
              clientY = e.clientY;
            } else if (e.type === "touchmove") {
              clientX = e.touches[0].clientX;
              clientY = e.touches[0].clientY;
            }

            // 获取水培箱的位置
            const hydroRect = hydroBody.getBoundingClientRect();

            // 计算植物新位置
            let newX = clientX - hydroRect.left - offsetX;
            let newY = clientY - hydroRect.top - offsetY;

            // 限制在容器范围内
            newX = Math.max(
              0,
              Math.min(newX, hydroRect.width - plant.offsetWidth)
            );
            newY = Math.max(
              0,
              Math.min(newY, hydroRect.height - plant.offsetHeight)
            );

            plant.style.left = `${newX}px`;
            plant.style.top = `${newY}px`;

            e.preventDefault();
          }

          function stopDrag() {
            isDragging = false;
            document.removeEventListener("mousemove", drag);
            document.removeEventListener("touchmove", drag);
          }
        }

        // 添加控制按钮功能
        document.querySelectorAll(".control-btn").forEach((btn) => {
          btn.addEventListener("click", function () {
            const action = this.textContent.trim();

            // 添加动画效果
            this.style.transform = "scale(0.95)";
            this.style.boxShadow = "0 2px 5px rgba(0, 0, 0, 0.3)";

            setTimeout(() => {
              this.style.transform = "";
              this.style.boxShadow = "0 4px 8px rgba(0, 0, 0, 0.2)";
            }, 200);
          });
        });
      });
    </script>
  </body>
</html>
